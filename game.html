<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game - EZ Fitness</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* éŠæˆ²æ ¸å¿ƒæ¨£å¼ */
        .game-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 350px;
            /* å¢åŠ é«˜åº¦ä»¥å®¹ç´æ›´å¤§çš„è§’è‰² */
            position: relative;
        }

        /* æ´¾å¤§æ˜Ÿé»æ“Šç›®æ¨™ */
        .click-target {
            position: absolute;
            bottom: 30px;
            right: 50px;
            font-size: 80px;
            /* è®“æ´¾å¤§æ˜Ÿæ›´å¤§ */
            cursor: pointer;
            transition: transform 0.1s ease, filter 0.1s ease;
            /* user-select: none; */
        }

        /* æ´¾å¤§æ˜Ÿé»æ“Šæ™‚çš„é–ƒçˆæ•ˆæœ (New!) */
        .click-target.clicked {
            transform: scale(0.95);
            filter: drop-shadow(0 0 10px #ff69b4);
            /* ç²‰ç´…è‰²å…‰æšˆ */
        }

        /* æµ·ç¶¿å¯¶å¯¶äººç‰© */
        .spongebob-person {
            font-size: 150px;
            /* æ”¾å¤§æµ·ç¶¿å¯¶å¯¶ */
            text-align: center;
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            /* æ›´èª‡å¼µçš„å½ˆæ€§éæ¸¡ */
            position: relative;
            z-index: 10;
        }

        /* æ»¿ç´šå‹åˆ©å‹•ç•« (New!) */
        .spongebob-person.champion {
            animation: pulse-glow 1.5s infinite alternate;
        }

        @keyframes pulse-glow {
            from {
                filter: drop-shadow(0 0 8px #ffeb3b) drop-shadow(0 0 15px #0ea5e9);
                transform: scale(1.4);
            }

            to {
                filter: drop-shadow(0 0 15px #ffeb3b) drop-shadow(0 0 25px #0ea5e9);
                transform: scale(1.45);
            }
        }


        .stats {
            text-align: center;
            margin-top: 30px;
            font-size: 18px;
        }

        .strength-bar {
            width: 100%;
            height: 35px;
            /* ç¨å¾®åŠ é«˜åŠ›é‡æ¢ */
            background-color: #e0e0e0;
            border-radius: 18px;
            margin-top: 15px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .strength-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffeb3b, #0ea5e9);
            /* æµ·ç¶¿å¯¶å¯¶ä¸»é¡Œè‰² */
            width: 0%;
            transition: width 0.4s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0f172a;
            /* æ·±è‰²å­—é«” */
            font-weight: bold;
            font-size: 1.1rem;
            text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.5);
        }

        .reset-btn {
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <header>
        <div class="title">EZ Fitness</div>
    </header>

    <aside>
        <ul class="no-padding">
            <li><a href="home.html">Home / Introduction</a></li>
            <li><a href="bmi.html">BMI Count</a></li>
            <li><a href="3DMuscle.html">3D Muscle</a></li>
            <li><a href="instructions.html">Steps Instruction</a>
                <ul class="no-padding">
                    <li class="bodypart no-border-bottom"><a href="instructions.html#upfront">&nbsp;&nbsp;&nbsp;&nbsp;Up
                            Front</a></li>
                    <li class="bodypart no-border-bottom"><a href="instructions.html#upback">&nbsp;&nbsp;&nbsp;&nbsp;Up
                            Back</a></li>
                    <li class="bodypart no-border-bottom"><a href="instructions.html#lowfront">&nbsp;&nbsp;&nbsp;&nbsp;Low
                            Front</a></li>
                    <li class="bodypart"><a href="instructions.html#lowback">&nbsp;&nbsp;&nbsp;&nbsp;Low Back</a></li>
                </ul>
            </li>
            <li><a href="game.html">Game</a></li>
            <li><a href="ai-chat.html">AI Chat</a></li>
        </ul>
    </aside>

    <main>
        <section class="spacer-50"></section>
        <section id="game">
            <div class="frame">
                <!-- <h2>Bikini Bottom Workout Game èŸ¹å ¡ç‹å¥èº«éŠæˆ²</h2> -->

                <div class="game-container">
                    <div class="spongebob-person" id="spongebob">ğŸ§½</div>
                    <div class="click-target" id="patrick">
                        <img src="svg/spongebob1.1.png" alt="å¯æ„›æµ·ç¶¿å¯¶å¯¶" class="spongebob-icon">
                    </div>
                </div>

                <div class="stats">
                    <div>
                        <strong>Strongness Level: <span id="strengthLevel">0</span>/100</strong>
                    </div>
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <div class="mt-3 text-secondary">
                        <p id="message">Feed Patrick! é¤µé£Ÿæ´¾å¤§æ˜Ÿï¼Œè®“æµ·ç¶¿å¯¶å¯¶è®Šå¼·å£¯ï¼</p>
                    </div>
                    <button type="button" id="resetBtn" class="btn btn-secondary reset-btn">Reset Game é‡è¨­éŠæˆ²</button>
                </div>
            </div>
        </section>
    </main>

    <script>
        (function () {
            let strengthLevel = 0;
            const maxStrength = 100;
            const patrick = document.getElementById('patrick'); // æ´¾å¤§æ˜Ÿé»æ“Šç›®æ¨™
            const spongebob = document.getElementById('spongebob'); // æµ·ç¶¿å¯¶å¯¶äººç‰©
            const strengthLevelDisplay = document.getElementById('strengthLevel');
            const strengthFill = document.getElementById('strengthFill');
            const message = document.getElementById('message');
            const resetBtn = document.getElementById('resetBtn');

            // --- éŸ³æ•ˆå‡½æ•¸ï¼šæ›´é…·çš„é›»å­éŸ³æ•ˆ ---
            function playSound(frequency = 800) {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                oscillator.type = 'square'; // ä½¿ç”¨æ–¹æ³¢è®“è²éŸ³æ›´é›»å­åŒ–

                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.15); // ç¨å¾®å»¶é•·éŸ³æ•ˆ

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.15);
            }

            function updateStrength() {
                if (strengthLevel >= maxStrength) {
                    message.textContent = 'Already a CHAMPION! ä»–å·²ç¶“æ˜¯å† è»äº†ï¼';
                    message.style.color = '#ff69b4';
                    return;
                }

                // å¢åŠ åŠ›é‡å€¼
                strengthLevel = Math.min(strengthLevel + 5, maxStrength);
                strengthLevelDisplay.textContent = strengthLevel;

                const percentage = (strengthLevel / maxStrength) * 100;
                strengthFill.style.width = percentage + '%';
                strengthFill.textContent = percentage > 10 ? Math.round(percentage) + '%' : '';

                // --- æ ¹æ“šåŠ›é‡ç­‰ç´šæ›´æ–°æµ·ç¶¿å¯¶å¯¶å¤–è§€ ---
                spongebob.classList.remove('champion'); // é‡ç½®å† è»ç‹€æ…‹

                if (strengthLevel < 20) {
                    spongebob.textContent = 'ğŸ¥º'; // è»Ÿå¼±çš„è‡‰
                    spongebob.style.transform = 'scale(1)';
                } else if (strengthLevel < 40) {
                    spongebob.textContent = 'ğŸ˜„'; // ç¨å¾®é–‹å¿ƒ
                    spongebob.style.transform = 'scale(1.1) rotate(-2deg)';
                } else if (strengthLevel < 60) {
                    spongebob.textContent = 'ğŸ˜'; // æˆ´ä¸Šå¢¨é¡
                    spongebob.style.transform = 'scale(1.2) rotate(2deg)';
                } else if (strengthLevel < 80) {
                    spongebob.textContent = 'ğŸ’ªğŸ˜'; // ç§€å‡ºè‚Œè‚‰
                    spongebob.style.transform = 'scale(1.3) rotate(0deg)';
                } else if (strengthLevel < 100) {
                    spongebob.textContent = 'ğŸ¦¾ğŸ’ªğŸ˜'; // è®Šè¶…ç´šè³½äºäºº
                    spongebob.style.transform = 'scale(1.4) rotate(5deg)';
                } else {
                    // é”åˆ°æ»¿ç´š
                    spongebob.textContent = 'â­ğŸ¦¾ğŸ’ª';
                    spongebob.style.transform = 'scale(1.4)';
                    spongebob.classList.add('champion'); // å•Ÿç”¨å† è»å‹•ç•«
                    message.textContent = 'ğŸ‰ You are a Bikini Bottom CHAMPION! æ¯”å¥‡å ¡å† è»ï¼';
                    message.style.color = '#ff69b4';
                    playSound(1200); // æ»¿ç´šæ™‚æ’­æ”¾æ›´é«˜éŸ³çš„å‹åˆ©éŸ³æ•ˆ
                    return; // æ»¿ç´šå¾Œä¸åŸ·è¡Œå¾ŒçºŒè¨Šæ¯æ›´æ–°
                }

                // --- è¨Šæ¯æ›´æ–° ---
                if (strengthLevel >= 80) {
                    message.textContent = 'Almost there, Spongebob! å¿«åˆ°äº†ï¼Œæµ·ç¶¿å¯¶å¯¶ï¼';
                    message.style.color = '#0ea5e9';
                } else if (strengthLevel >= 50) {
                    message.textContent = 'Great Progress! Keep feeding Patrick! é€²åº¦å¾ˆå¥½ï¼ç¹¼çºŒé¤µé£Ÿæ´¾å¤§æ˜Ÿï¼';
                    message.style.color = '#f59e0b';
                } else if (strengthLevel >= 20) {
                    message.textContent = 'He is getting stronger! ä»–è¶Šä¾†è¶Šå¼·äº†ï¼';
                    message.style.color = '#f59e0b';
                } else {
                    message.textContent = 'Feed Patrick! é¤µé£Ÿæ´¾å¤§æ˜Ÿï¼Œè®“æµ·ç¶¿å¯¶å¯¶è®Šå¼·å£¯ï¼';
                    message.style.color = '#6b7280';
                }
            }

            // æ´¾å¤§æ˜Ÿé»æ“Šäº‹ä»¶
            patrick.addEventListener('click', function () {
                playSound();
                updateStrength();

                // åŠ å…¥é»æ“Šé–ƒçˆå‹•ç•«
                patrick.classList.add('clicked');
                setTimeout(() => {
                    patrick.classList.remove('clicked');
                }, 150);
            });

            // é‡è¨­æŒ‰éˆ•
            resetBtn.addEventListener('click', function () {
                strengthLevel = 0;
                strengthLevelDisplay.textContent = '0';
                strengthFill.style.width = '0%';
                strengthFill.textContent = '';
                spongebob.textContent = 'ğŸ¥º';
                spongebob.style.transform = 'scale(1)';
                spongebob.classList.remove('champion');
                message.textContent = 'Feed Patrick! é¤µé£Ÿæ´¾å¤§æ˜Ÿï¼Œè®“æµ·ç¶¿å¯¶å¯¶è®Šå¼·å£¯ï¼';
                message.style.color = '#6b7280';
            });

            // éµç›¤æ·å¾‘ (ç©ºç™½éµ)
            document.addEventListener('keydown', function (e) {
                if (e.code === 'Space') {
                    e.preventDefault();
                    patrick.click();
                }
            });
        })();
    </script>

    <footer>
        <p>2025 EZ Fitness Start.</p>
    </footer>

</body>

</html>